---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getArea, getPOIsForArea, getTrailsForArea, getChildAreas, getAccessPoints } from '../lib/data';

const coxMtn = getArea('cox-mountain');
const coxTrails = getTrailsForArea('cox-mountain');
const coxPois = getPOIsForArea('cox-mountain');
const accessPoints = getAccessPoints('cox-mountain');
---

<BaseLayout title="Durham Trails â€” Cox Mountain, Eno River State Park" fullWidth>
  <!-- Hero -->
  <section class="relative bg-forest-800 text-white">
    <div id="hero-map" class="absolute inset-0 opacity-30"></div>
    <div class="relative z-10 max-w-4xl mx-auto px-4 py-20 text-center">
      <p class="text-forest-300 text-sm font-medium tracking-wide uppercase mb-2">Durham Trails</p>
      <h1 class="font-display text-4xl md:text-5xl font-bold mb-4">Cox Mountain</h1>
      <p class="text-lg text-forest-200 mb-2">Eno River State Park</p>
      <p class="text-base text-forest-300 max-w-2xl mx-auto mt-4">
        Historic fords, mill ruins, abandoned roads, and some of the most rugged
        terrain in the Triangle. Where trails reveal centuries of history.
      </p>
      <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mt-8">
        <a href="/map" class="bg-forest-500 hover:bg-forest-400 text-white px-6 py-3 rounded-lg font-medium transition-colors">
          Explore the Map
        </a>
        <a href="/areas/cox-mountain" class="bg-white/10 hover:bg-white/20 text-white px-6 py-3 rounded-lg font-medium transition-colors border border-white/20">
          Area Details
        </a>
      </div>
    </div>
  </section>

  <!-- What's Here -->
  <section class="max-w-4xl mx-auto px-4 py-12">
    <h2 class="font-display text-2xl font-bold text-stone-800 mb-4">What's Here</h2>
    <p class="text-stone-600 mb-8 leading-relaxed">
      Cox Mountain sits at a strategic corridor between Durham and Hillsborough, where
      several historic fords allowed the Fish Dam Road and the old Durham-Hillsborough
      Coach Road to cross the Eno. The trails here â€” both official and unofficial â€” follow
      paths shaped by geology, industry, and centuries of human movement. Stone foundations,
      mill ruins, and even abandoned cars hide in these woods.
    </p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-6">
        <div class="text-2xl mb-2">ğŸ›ï¸</div>
        <h3 class="font-display font-bold text-stone-800">Historic Sites</h3>
        <p class="text-stone-600 text-sm mt-2">
          Few's Ford, Holden's Mill, Piper-Cox House, the Wilderness Cabin,
          and stone foundations scattered through the woods.
        </p>
      </div>
      <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-6">
        <div class="text-2xl mb-2">ğŸ¥¾</div>
        <h3 class="font-display font-bold text-stone-800">Trails</h3>
        <p class="text-stone-600 text-sm mt-2">
          The challenging Cox Mountain loop, Buckquarter Creek Trail, Fanny's Ford Trail,
          plus an extensive network of unofficial social trails.
        </p>
      </div>
      <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-6">
        <div class="text-2xl mb-2">ğŸ—ºï¸</div>
        <h3 class="font-display font-bold text-stone-800">Deep History</h3>
        <p class="text-stone-600 text-sm mt-2">
          Native American trading paths, colonial-era fords, 19th-century mills,
          old roadbeds, and a slave cemetery in the woods.
        </p>
      </div>
    </div>
  </section>

  <!-- Points of Interest -->
  <section class="bg-stone-50 py-12">
    <div class="max-w-4xl mx-auto px-4">
      <h2 class="font-display text-2xl font-bold text-stone-800 mb-6">Points of Interest</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {coxPois.map(poi => {
          const icons = {
            historic: 'ğŸ›ï¸', ruins: 'ğŸ§±', bridge: 'ğŸŒ‰', water: 'ğŸ’§', sign: 'ğŸ“‹', natural: 'ğŸŒ¿'
          } as any;
          return (
            <div class="bg-white rounded-lg border border-stone-200 p-4 flex gap-3">
              <span class="text-xl flex-shrink-0">{icons[poi.type] || 'ğŸ“'}</span>
              <div>
                <h3 class="font-medium text-stone-800 text-sm">{poi.name}</h3>
                <p class="text-stone-600 text-xs mt-1 line-clamp-2">{poi.description}</p>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </section>

  <!-- Access -->
  <section class="max-w-4xl mx-auto px-4 py-12">
    <h2 class="font-display text-2xl font-bold text-stone-800 mb-6">Getting There</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {accessPoints.map(ap => (
        <div class="bg-white rounded-lg border border-stone-200 p-4">
          <h3 class="font-medium text-stone-800 text-sm">{ap.name}</h3>
          <p class="text-stone-600 text-xs mt-1">{ap.description}</p>
          {ap.restrooms && <span class="inline-block mt-2 text-xs bg-forest-50 text-forest-700 px-2 py-0.5 rounded">ğŸš» Restrooms</span>}
        </div>
      ))}
    </div>
    <p class="text-stone-500 text-sm mt-6">
      <strong>Note:</strong> The swinging bridge is currently closed due to Hurricane Chantal
      flooding. Eastern trail access from the lower parking lot is limited until repairs are complete.
    </p>
  </section>

  <!-- Coming Soon -->
  <section class="bg-forest-800 text-white py-10">
    <div class="max-w-4xl mx-auto px-4 text-center">
      <h2 class="font-display text-xl font-bold mb-3">More Coming Soon</h2>
      <p class="text-forest-300 text-sm max-w-xl mx-auto">
        We're building detailed trail maps, GPS tracks, and deep history writeups for
        every trail and point of interest in the Cox Mountain area. This is just the beginning.
      </p>
    </div>
  </section>
</BaseLayout>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    const mapEl = document.getElementById('hero-map');
    if (!mapEl || typeof L === 'undefined') return;
    const map = L.map(mapEl, {
      zoomControl: false, attributionControl: false,
      dragging: false, scrollWheelZoom: false,
      doubleClickZoom: false, touchZoom: false,
    }).setView([36.077, -79.007], 15);
    L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
      maxZoom: 17,
    }).addTo(map);
  });
</script>
